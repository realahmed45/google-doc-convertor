<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Google Docs to Jekyll Markdown Converter</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
        background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
        min-height: 100vh;
        padding: 20px;
        color: white;
      }

      .container {
        max-width: 1400px;
        margin: 0 auto;
      }

      .header {
        text-align: center;
        color: white;
        margin-bottom: 40px;
      }

      .header h1 {
        font-size: 2.5rem;
        margin-bottom: 10px;
        font-weight: 700;
        color: #ff7700;
      }

      .header p {
        font-size: 1.2rem;
        opacity: 0.9;
        margin-bottom: 20px;
        color: #e5e5e5;
      }

      .header .brand {
        background: rgba(255, 119, 0, 0.1);
        backdrop-filter: blur(10px);
        padding: 8px 16px;
        border-radius: 20px;
        display: inline-block;
        font-size: 0.9rem;
        border: 1px solid rgba(255, 119, 0, 0.3);
        color: #ff7700;
      }

      .instructions {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border-radius: 16px;
        padding: 30px;
        margin-bottom: 30px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        color: #1a1a1a;
      }

      .instructions h3 {
        color: #1a1a1a;
        margin-bottom: 20px;
        font-size: 1.4rem;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .instructions h3 i {
        color: #ff7700;
      }

      .steps {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-bottom: 20px;
      }

      .step {
        background: #f8f8f8;
        padding: 20px;
        border-radius: 12px;
        border-left: 4px solid #ff7700;
      }

      .step-number {
        background: #ff7700;
        color: white;
        width: 24px;
        height: 24px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.8rem;
        font-weight: 600;
        margin-bottom: 10px;
      }

      .step h4 {
        color: #1a1a1a;
        margin-bottom: 8px;
        font-size: 1rem;
      }

      .step p {
        color: #666;
        font-size: 0.9rem;
        line-height: 1.5;
      }

      .converter {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border-radius: 20px;
        padding: 40px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(255, 255, 255, 0.3);
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 40px;
        min-height: 600px;
        color: #1a1a1a;
      }

      @media (max-width: 1024px) {
        .converter {
          grid-template-columns: 1fr;
          gap: 30px;
        }
      }

      .input-section,
      .output-section {
        display: flex;
        flex-direction: column;
      }

      .section-title {
        font-size: 1.4rem;
        margin-bottom: 20px;
        color: #1a1a1a;
        display: flex;
        align-items: center;
        gap: 12px;
        font-weight: 600;
      }

      .section-title i {
        color: #ff7700;
        font-size: 1.2rem;
      }

      .controls {
        margin-bottom: 20px;
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
      }

      .btn {
        padding: 12px 24px;
        border: none;
        border-radius: 10px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 8px;
        text-decoration: none;
      }

      .btn-primary {
        background: linear-gradient(135deg, #ff7700, #ff9933);
        color: white;
        box-shadow: 0 4px 12px rgba(255, 119, 0, 0.3);
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(255, 119, 0, 0.4);
      }

      .btn-secondary {
        background: #f1f1f1;
        color: #333;
        border: 1px solid #ddd;
      }

      .btn-secondary:hover {
        background: #e0e0e0;
        transform: translateY(-1px);
      }

      .btn-success {
        background: #10b981;
        color: white;
      }

      .btn-success:hover {
        background: #059669;
        transform: translateY(-1px);
      }

      .file-input {
        display: none;
      }

      .file-label {
        padding: 12px 24px;
        background: #f8f8f8;
        color: #333;
        border: 2px dashed #ccc;
        border-radius: 10px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        font-weight: 600;
        transition: all 0.3s ease;
        text-align: center;
        justify-content: center;
      }

      .file-label:hover {
        border-color: #ff7700;
        background: #fff5f0;
        color: #ff7700;
      }

      .textarea {
        flex: 1;
        border: 2px solid #e0e0e0;
        border-radius: 12px;
        padding: 20px;
        font-size: 14px;
        font-family: "JetBrains Mono", "Monaco", "Menlo", monospace;
        resize: none;
        min-height: 400px;
        outline: none;
        transition: all 0.3s ease;
        line-height: 1.5;
      }

      .textarea:focus {
        border-color: #ff7700;
        box-shadow: 0 0 0 3px rgba(255, 119, 0, 0.1);
      }

      #htmlInput {
        background: #fafafa;
        color: #333;
      }

      #markdownOutput {
        background: #1a1a1a;
        color: #e0e0e0;
        font-family: "JetBrains Mono", monospace;
      }

      .yaml-section {
        background: #fff7e6;
        border: 1px solid #ffd699;
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 20px;
      }

      .yaml-section h4 {
        color: #cc5500;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .yaml-inputs {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
        margin-bottom: 15px;
      }

      .input-group {
        display: flex;
        flex-direction: column;
        gap: 5px;
      }

      .input-group label {
        font-size: 0.85rem;
        font-weight: 500;
        color: #cc5500;
      }

      .input-group input {
        padding: 8px 12px;
        border: 1px solid #ffd699;
        border-radius: 6px;
        font-size: 0.85rem;
        background: white;
      }

      .input-group input:focus {
        outline: none;
        border-color: #ff7700;
        box-shadow: 0 0 0 2px rgba(255, 119, 0, 0.1);
      }

      .yaml-preview {
        background: #2a2a2a;
        color: #ffd699;
        padding: 15px;
        border-radius: 8px;
        font-family: "JetBrains Mono", monospace;
        font-size: 0.8rem;
        white-space: pre-wrap;
        max-height: 150px;
        overflow-y: auto;
      }

      .image-section {
        background: #f0f8ff;
        border: 1px solid #b3d9ff;
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 20px;
      }

      .image-section h4 {
        color: #0066cc;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .image-upload-area {
        border: 2px dashed #b3d9ff;
        border-radius: 8px;
        padding: 20px;
        text-align: center;
        background: #f8fcff;
        margin-bottom: 15px;
      }

      .image-upload-area.dragover {
        border-color: #0066cc;
        background: #e6f3ff;
      }

      .image-list {
        max-height: 200px;
        overflow-y: auto;
        background: white;
        border-radius: 8px;
        padding: 10px;
      }

      .image-item {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 8px;
        border-bottom: 1px solid #eee;
      }

      .image-item:last-child {
        border-bottom: none;
      }

      .image-preview {
        width: 40px;
        height: 40px;
        object-fit: cover;
        border-radius: 4px;
        border: 1px solid #ddd;
      }

      .footer {
        text-align: center;
        color: white;
        margin-top: 40px;
        padding-top: 30px;
        border-top: 1px solid rgba(255, 255, 255, 0.2);
      }

      .footer h4 {
        margin-bottom: 15px;
        font-size: 1.1rem;
        color: #ff7700;
      }

      .footer p {
        opacity: 0.8;
        margin-bottom: 10px;
      }

      .footer a {
        color: #ff7700;
        text-decoration: none;
      }

      .footer a:hover {
        text-decoration: underline;
      }

      .notification {
        position: fixed;
        top: 20px;
        right: 20px;
        background: white;
        padding: 16px 20px;
        border-radius: 10px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        transform: translateX(400px);
        transition: transform 0.3s ease;
        z-index: 1000;
        border-left: 4px solid #10b981;
        display: flex;
        align-items: center;
        gap: 10px;
        min-width: 300px;
        color: #333;
      }

      .notification.show {
        transform: translateX(0);
      }

      .notification i {
        color: #10b981;
      }

      .notification.error {
        border-left-color: #ef4444;
      }

      .notification.error i {
        color: #ef4444;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1><i class="fas fa-magic"></i> Google Docs to Jekyll Markdown</h1>
        <p>
          Convert your Google Docs to professional Jekyll markdown for your
          cybersecurity portfolio
        </p>
        <div class="brand">Powered by CyberSecurityRockstar</div>
      </div>

      <div class="instructions">
        <h3><i class="fas fa-lightbulb"></i> How to Use This Converter</h3>
        <div class="steps">
          <div class="step">
            <div class="step-number">1</div>
            <h4>Export from Google Docs</h4>
            <p>Go to File → Download → Web Page (.html) in your Google Doc</p>
          </div>
          <div class="step">
            <div class="step-number">2</div>
            <h4>Upload HTML & Images</h4>
            <p>Upload the HTML file and any images from your Google Doc</p>
          </div>
          <div class="step">
            <div class="step-number">3</div>
            <h4>Fill Project Details</h4>
            <p>Add your project information in the YAML form below</p>
          </div>
          <div class="step">
            <div class="step-number">4</div>
            <h4>Convert & Download</h4>
            <p>Click convert, copy the markdown, and save as project-name.md</p>
          </div>
        </div>
        <div
          style="
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
          "
        >
          <h4 style="color: #856404; margin-bottom: 10px">
            <i class="fas fa-info-circle"></i> Image Handling
          </h4>
          <p style="color: #856404; margin: 0">
            When you download your Google Doc as HTML, images are embedded as
            base64 data. Upload your images separately below to get proper
            markdown image references.
          </p>
        </div>
      </div>

      <div class="converter">
        <div class="input-section">
          <h2 class="section-title">
            <i class="fab fa-google"></i>
            HTML Input
          </h2>

          <div class="controls">
            <label for="fileInput" class="file-label">
              <i class="fas fa-cloud-upload-alt"></i>
              Upload HTML File
            </label>
            <input
              type="file"
              id="fileInput"
              class="file-input"
              accept=".html,.htm"
            />

            <button class="btn btn-primary" onclick="convertToMarkdown()">
              <i class="fas fa-magic"></i>
              Convert to Markdown
            </button>

            <button class="btn btn-secondary" onclick="clearAll()">
              <i class="fas fa-trash"></i>
              Clear All
            </button>
          </div>

          <textarea
            id="htmlInput"
            class="textarea"
            placeholder="Paste your Google Docs HTML content here, or upload a file using the button above...

Example:
<h1>My Amazing Project</h1>
<p>This project demonstrates...</p>
<h2>Technologies Used</h2>
<ul>
  <li>Python</li>
  <li>TensorFlow</li>
</ul>"
          ></textarea>

          <div class="image-section">
            <h4><i class="fas fa-images"></i> Image Upload</h4>
            <div class="image-upload-area" id="imageUploadArea">
              <i
                class="fas fa-cloud-upload-alt"
                style="font-size: 2rem; color: #0066cc; margin-bottom: 10px"
              ></i>
              <p style="margin-bottom: 10px; color: #0066cc">
                Drag & drop images here or click to browse
              </p>
              <input
                type="file"
                id="imageInput"
                multiple
                accept="image/*"
                style="display: none"
              />
              <button
                type="button"
                class="btn btn-secondary"
                onclick="document.getElementById('imageInput').click()"
              >
                <i class="fas fa-folder-open"></i> Browse Images
              </button>
            </div>
            <div class="image-list" id="imageList"></div>
          </div>
        </div>

        <div class="output-section">
          <h2 class="section-title">
            <i class="fab fa-markdown"></i>
            Jekyll Markdown Output
          </h2>

          <div class="yaml-section">
            <h4><i class="fas fa-cog"></i> Project Information</h4>
            <div class="yaml-inputs">
              <div class="input-group">
                <label>Project Title</label>
                <input
                  type="text"
                  id="projectTitle"
                  placeholder="My Amazing Project"
                />
              </div>
              <div class="input-group">
                <label>Description</label>
                <input
                  type="text"
                  id="projectDesc"
                  placeholder="Brief project description"
                />
              </div>
              <div class="input-group">
                <label>Read Time</label>
                <input type="text" id="readTime" placeholder="10 minute read" />
              </div>
              <div class="input-group">
                <label>Tags (comma separated)</label>
                <input
                  type="text"
                  id="projectTags"
                  placeholder="Python, Machine Learning, AI"
                />
              </div>
              <div class="input-group">
                <label>GitHub URL</label>
                <input
                  type="url"
                  id="githubUrl"
                  placeholder="https://github.com/username/project"
                />
              </div>
              <div class="input-group">
                <label>Demo URL</label>
                <input
                  type="url"
                  id="demoUrl"
                  placeholder="https://demo-link.com"
                />
              </div>
            </div>
            <div class="yaml-preview" id="yamlPreview">
              --- layout: project title: "Your Project Title" description:
              "Brief description" featured: true read_time: "10 minute read"
              tags: [Python, Machine Learning] github:
              "https://github.com/username/project" demo:
              "https://demo-link.com" date: 2024-08-08 ---
            </div>
          </div>

          <div class="controls">
            <button class="btn btn-success" onclick="copyToClipboard()">
              <i class="fas fa-copy"></i>
              Copy Markdown
            </button>

            <button class="btn btn-secondary" onclick="downloadMarkdown()">
              <i class="fas fa-download"></i>
              Download .md File
            </button>

            <button
              class="btn btn-secondary"
              onclick="downloadImages()"
              style="display: none"
              id="downloadImagesBtn"
            >
              <i class="fas fa-download"></i>
              Download Images
            </button>
          </div>

          <textarea
            id="markdownOutput"
            class="textarea"
            readonly
            placeholder="Your Jekyll-ready markdown will appear here...

The output will include:
- YAML front matter with project details
- Clean markdown formatted content
- Proper heading structure
- Code blocks and formatting preserved
- Image references with proper paths"
          ></textarea>
        </div>
      </div>

      <div class="footer">
        <h4>
          <i class="fas fa-graduation-cap"></i> For CyberSecurity Students
        </h4>
        <p>
          This tool is designed to help cybersecurity students easily create
          professional portfolio content.
        </p>
        <p>
          Need help? Check out the
          <a href="#documentation">complete documentation</a> or visit
          <a href="https://cybersecurityrockstar.com"
            >CyberSecurityRockstar.com</a
          >
        </p>
      </div>
    </div>

    <script>
      // Global variables for image handling
      let uploadedImages = [];
      let imageCounter = 0;

      // File input handler
      document
        .getElementById("fileInput")
        .addEventListener("change", function (e) {
          const file = e.target.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onload = function (e) {
              document.getElementById("htmlInput").value = e.target.result;
              showNotification("HTML file uploaded successfully!");
            };
            reader.readAsText(file);
          }
        });

      // Image upload handlers
      const imageUploadArea = document.getElementById("imageUploadArea");
      const imageInput = document.getElementById("imageInput");

      imageUploadArea.addEventListener("click", () => {
        imageInput.click();
      });

      imageUploadArea.addEventListener("dragover", (e) => {
        e.preventDefault();
        imageUploadArea.classList.add("dragover");
      });

      imageUploadArea.addEventListener("dragleave", () => {
        imageUploadArea.classList.remove("dragover");
      });

      imageUploadArea.addEventListener("drop", (e) => {
        e.preventDefault();
        imageUploadArea.classList.remove("dragover");
        const files = Array.from(e.dataTransfer.files).filter((file) =>
          file.type.startsWith("image/")
        );
        handleImageFiles(files);
      });

      imageInput.addEventListener("change", (e) => {
        const files = Array.from(e.target.files);
        handleImageFiles(files);
      });

      function handleImageFiles(files) {
        files.forEach((file) => {
          const reader = new FileReader();
          reader.onload = function (e) {
            const imageData = {
              id: ++imageCounter,
              name: file.name,
              data: e.target.result,
              file: file,
            };
            uploadedImages.push(imageData);
            displayImageList();
            showNotification(`Image "${file.name}" uploaded successfully!`);
          };
          reader.readAsDataURL(file);
        });
      }

      function displayImageList() {
        const imageList = document.getElementById("imageList");
        const downloadBtn = document.getElementById("downloadImagesBtn");

        imageList.innerHTML = "";

        if (uploadedImages.length > 0) {
          downloadBtn.style.display = "flex";
        } else {
          downloadBtn.style.display = "none";
        }

        uploadedImages.forEach((image) => {
          const imageItem = document.createElement("div");
          imageItem.className = "image-item";
          imageItem.innerHTML = `
            <img src="${image.data}" alt="${image.name}" class="image-preview">
            <span style="flex: 1; font-size: 0.9rem;">${image.name}</span>
            <button onclick="removeImage(${image.id})" style="background: none; border: none; color: #ef4444; cursor: pointer;">
              <i class="fas fa-trash"></i>
            </button>
          `;
          imageList.appendChild(imageItem);
        });
      }

      function removeImage(imageId) {
        uploadedImages = uploadedImages.filter((img) => img.id !== imageId);
        displayImageList();
        showNotification("Image removed successfully!");
      }

      // Update YAML preview when inputs change
      const yamlInputs = [
        "projectTitle",
        "projectDesc",
        "readTime",
        "projectTags",
        "githubUrl",
        "demoUrl",
      ];
      yamlInputs.forEach((id) => {
        document
          .getElementById(id)
          .addEventListener("input", updateYamlPreview);
      });

      function updateYamlPreview() {
        const title =
          document.getElementById("projectTitle").value || "Your Project Title";
        const desc =
          document.getElementById("projectDesc").value || "Brief description";
        const readTime =
          document.getElementById("readTime").value || "10 minute read";
        const tags =
          document.getElementById("projectTags").value ||
          "Python, Machine Learning";
        const github =
          document.getElementById("githubUrl").value ||
          "https://github.com/username/project";
        const demo =
          document.getElementById("demoUrl").value || "https://demo-link.com";

        const tagArray = tags
          .split(",")
          .map((tag) => tag.trim())
          .filter((tag) => tag);
        const formattedTags =
          tagArray.length > 0
            ? `[${tagArray.join(", ")}]`
            : "[Python, Machine Learning]";

        const yaml = `---
layout: project
title: "${title}"
description: "${desc}"
featured: true
read_time: "${readTime}"
tags: ${formattedTags}
github: "${github}"
demo: "${demo}"
date: ${new Date().toISOString().split("T")[0]}
---`;

        document.getElementById("yamlPreview").textContent = yaml;
      }

      function convertToMarkdown() {
        const htmlContent = document.getElementById("htmlInput").value.trim();
        if (!htmlContent) {
          showNotification("Please add some HTML content first!", "error");
          return;
        }

        // Create temporary div to parse HTML
        const tempDiv = document.createElement("div");
        tempDiv.innerHTML = htmlContent;

        let markdown = generateYamlFrontMatter() + "\n\n";

        // Convert HTML elements to markdown
        function processNode(node) {
          if (node.nodeType === Node.TEXT_NODE) {
            return node.textContent.trim();
          }

          if (!node.tagName) return "";

          const tagName = node.tagName.toLowerCase();
          let result = "";

          switch (tagName) {
            case "h1":
              result = `# ${getTextContent(node)}\n\n`;
              break;
            case "h2":
              result = `## ${getTextContent(node)}\n\n`;
              break;
            case "h3":
              result = `### ${getTextContent(node)}\n\n`;
              break;
            case "h4":
              result = `#### ${getTextContent(node)}\n\n`;
              break;
            case "h5":
              result = `##### ${getTextContent(node)}\n\n`;
              break;
            case "h6":
              result = `###### ${getTextContent(node)}\n\n`;
              break;
            case "p":
              const pText = processChildren(node);
              if (pText.trim()) {
                result = `${pText}\n\n`;
              }
              break;
            case "strong":
            case "b":
              result = `**${processChildren(node)}**`;
              break;
            case "em":
            case "i":
              result = `*${processChildren(node)}*`;
              break;
            case "code":
              result = `\`${getTextContent(node)}\``;
              break;
            case "pre":
              const codeText = getTextContent(node);
              result = `\`\`\`\n${codeText}\n\`\`\`\n\n`;
              break;
            case "a":
              const href = node.getAttribute("href");
              const linkText = processChildren(node);
              result = href ? `[${linkText}](${href})` : linkText;
              break;
            case "ul":
              result = processChildren(node) + "\n";
              break;
            case "ol":
              result = processChildren(node) + "\n";
              break;
            case "li":
              const listText = processChildren(node);
              const isOrdered =
                node.parentElement.tagName.toLowerCase() === "ol";
              if (isOrdered) {
                const index =
                  Array.from(node.parentElement.children).indexOf(node) + 1;
                result = `${index}. ${listText}\n`;
              } else {
                result = `- ${listText}\n`;
              }
              break;
            case "blockquote":
              const quoteText = processChildren(node);
              result = `> ${quoteText}\n\n`;
              break;
            case "img":
              result = processImage(node);
              break;
            case "br":
              result = "\n";
              break;
            case "hr":
              result = "\n---\n\n";
              break;
            case "table":
              result = processTable(node);
              break;
            default:
              result = processChildren(node);
              break;
          }

          return result;
        }

        function processImage(imgNode) {
          const src = imgNode.getAttribute("src");
          const alt = imgNode.getAttribute("alt") || "Image";

          // Check if it's a base64 image from Google Docs
          if (src && src.startsWith("data:image/")) {
            // Try to find a matching uploaded image by comparing base64 data
            const matchingImage = uploadedImages.find((img) => {
              return img.data === src;
            });

            if (matchingImage) {
              // Use the uploaded image filename
              const imagePath = `/images/${matchingImage.name}`;
              return `![${alt}](${imagePath})\n\n`;
            } else {
              // Suggest manual image replacement
              const imageName = `image-${Date.now()}.png`;
              return `![${alt}](/images/${imageName})\n\n<!-- Note: Replace with actual image path -->\n\n`;
            }
          } else if (src) {
            // Regular image with URL
            return `![${alt}](${src})\n\n`;
          }

          return "";
        }

        function processChildren(node) {
          let result = "";
          for (let child of node.childNodes) {
            result += processNode(child);
          }
          return result;
        }

        function getTextContent(node) {
          return node.textContent || "";
        }

        function processTable(table) {
          const rows = table.querySelectorAll("tr");
          if (rows.length === 0) return "";

          let markdown = "\n";
          let isFirstRow = true;

          rows.forEach((row) => {
            const cells = row.querySelectorAll("td, th");
            const cellContents = Array.from(cells).map((cell) =>
              getTextContent(cell).replace(/\n/g, " ").trim()
            );

            markdown += "| " + cellContents.join(" | ") + " |\n";

            if (isFirstRow) {
              markdown +=
                "| " + cellContents.map(() => "---").join(" | ") + " |\n";
              isFirstRow = false;
            }
          });

          return markdown + "\n";
        }

        // Process the content
        const processedMarkdown = processChildren(tempDiv);
        markdown += cleanupMarkdown(processedMarkdown);

        // Add image references section if there are uploaded images
        if (uploadedImages.length > 0) {
          markdown += "\n\n## Image Files\n\n";
          markdown +=
            "The following images were uploaded with this document:\n\n";
          uploadedImages.forEach((img) => {
            markdown += `- ${img.name} → Place in \`/images/\` folder\n`;
          });
          markdown += "\n";
        }

        document.getElementById("markdownOutput").value = markdown;
        showNotification("Conversion completed successfully!");
      }

      function generateYamlFrontMatter() {
        const title =
          document.getElementById("projectTitle").value || "Your Project Title";
        const desc =
          document.getElementById("projectDesc").value ||
          "Brief project description";
        const readTime =
          document.getElementById("readTime").value || "10 minute read";
        const tags =
          document.getElementById("projectTags").value ||
          "Python, Machine Learning";
        const github = document.getElementById("githubUrl").value || "";
        const demo = document.getElementById("demoUrl").value || "";

        const tagArray = tags
          .split(",")
          .map((tag) => tag.trim())
          .filter((tag) => tag);
        const formattedTags =
          tagArray.length > 0
            ? `[${tagArray.join(", ")}]`
            : "[Python, Machine Learning]";

        let yaml = `---
layout: project
title: "${title}"
description: "${desc}"
featured: true
read_time: "${readTime}"
tags: ${formattedTags}`;

        if (github) yaml += `\ngithub: "${github}"`;
        if (demo) yaml += `\ndemo: "${demo}"`;

        yaml += `\ndate: ${new Date().toISOString().split("T")[0]}
---`;

        return yaml;
      }

      function cleanupMarkdown(markdown) {
        return markdown
          .replace(/\n{4,}/g, "\n\n\n")
          .replace(/\n(\d+\. |\- )/g, "\n$1")
          .replace(/[ \t]+$/gm, "")
          .replace(/^(#{1,6})\s*(.+)$/gm, "$1 $2")
          .replace(/\*{3,}/g, "**")
          .trim();
      }

      function copyToClipboard() {
        const markdownContent = document.getElementById("markdownOutput").value;
        if (!markdownContent) {
          showNotification(
            "No content to copy! Please convert first.",
            "error"
          );
          return;
        }

        navigator.clipboard
          .writeText(markdownContent)
          .then(() => {
            showNotification("Markdown copied to clipboard!");
          })
          .catch(() => {
            // Fallback for older browsers
            const textArea = document.createElement("textarea");
            textArea.value = markdownContent;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand("copy");
            document.body.removeChild(textArea);
            showNotification("Markdown copied to clipboard!");
          });
      }

      function downloadMarkdown() {
        const markdownContent = document.getElementById("markdownOutput").value;
        if (!markdownContent) {
          showNotification(
            "No content to download! Please convert first.",
            "error"
          );
          return;
        }

        const projectTitle =
          document.getElementById("projectTitle").value || "project";
        const filename =
          projectTitle
            .toLowerCase()
            .replace(/[^a-z0-9]+/g, "-")
            .replace(/^-|-$/g, "") + ".md";

        const blob = new Blob([markdownContent], { type: "text/markdown" });
        const url = URL.createObjectURL(blob);

        const a = document.createElement("a");
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);

        showNotification(`File downloaded as ${filename}`);
      }

      function downloadImages() {
        if (uploadedImages.length === 0) {
          showNotification("No images to download!", "error");
          return;
        }

        uploadedImages.forEach((image) => {
          const link = document.createElement("a");
          link.href = image.data;
          link.download = image.name;
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
        });

        showNotification(`Downloaded ${uploadedImages.length} images`);
      }

      function clearAll() {
        document.getElementById("htmlInput").value = "";
        document.getElementById("markdownOutput").value = "";
        uploadedImages = [];
        displayImageList();
        yamlInputs.forEach((id) => {
          document.getElementById(id).value = "";
        });
        updateYamlPreview();
        showNotification("All fields cleared!");
      }

      function showNotification(message, type = "success") {
        const notification = document.createElement("div");
        notification.className = `notification ${
          type === "error" ? "error" : ""
        }`;
        notification.innerHTML = `
                <i class="fas fa-${
                  type === "success" ? "check-circle" : "exclamation-circle"
                }"></i>
                <span>${message}</span>
            `;

        document.body.appendChild(notification);

        setTimeout(() => notification.classList.add("show"), 100);

        setTimeout(() => {
          notification.classList.remove("show");
          setTimeout(() => notification.remove(), 300);
        }, 3000);
      }

      // Initialize
      updateYamlPreview();
    </script>
  </body>
</html>
